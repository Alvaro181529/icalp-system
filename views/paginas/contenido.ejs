<%- include('../partials/header', {title, user}) %>
<div class="px-8 py-2">
    <div class="overflow-x-auto shadow-md sm:rounded-lg">
        <table id="result-table" class="w-full text-sm text-left rtl:text-right text-gray-600 ">
          <thead class="text-xs text-gray-200 uppercase bg-blue-950 ">
            <tr>
              <th class="px-4 py-3 text-left">
                Año
              </th>
              <th class="px-4 py-3 text-left">Mes</th>
              <th class="px-4 py-3 text-left">Cobros</th>
              <th class="px-4 py-3 text-left">Total</th>
            </tr>
  
          </thead>
          <tbody>
            <!-- Aquí se llenarán las filas con los resultados -->
          </tbody>
        </table>
      </div>
</div>
<script defer>
    const $ = (el) => document.querySelector(el);
    const resultTableBody = $("#result-table tbody");


    const fetchAndUpdateTable = async () => {
        const url = `/menu`;

        try {
          const response = await fetch(url);
          if (!response.ok) {
            throw new Error("Error en la búsqueda");
          }

          const data = await response.json(); 
          console.log(data)
          if (data && data.users && Array.isArray(data.users)) {
            totalPages = data.pages; 
            updateTable(data.users, totalPages); 
          } else {
            console.error("La estructura de la respuesta no es válida");
            alert("Hubo un problema con los resultados. Intenta nuevamente.");
          }
        } catch (error) {
          console.error("Error en la búsqueda:", error);
          alert("Hubo un problema al realizar la búsqueda. Intenta nuevamente.");
        }
      };

</script>
<%- include('../partials/footer') %>
